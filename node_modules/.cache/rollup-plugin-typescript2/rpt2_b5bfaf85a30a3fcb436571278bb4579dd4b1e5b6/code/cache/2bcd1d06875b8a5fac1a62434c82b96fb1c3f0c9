{"code":"import { NStartNode } from \"./node/nstartnode\";\r\nexport class NPageProcess {\r\n    constructor(id, cfg, container) {\r\n        /**\r\n         * 流程参数\r\n         */\r\n        this.params = {};\r\n        this.id = id;\r\n        this.name = cfg.name;\r\n        this.title = cfg.title;\r\n        this.nodes = cfg.nodes;\r\n        this.container = container;\r\n    }\r\n    /**\r\n     * 获取参数\r\n     * @param key   参数名，如果没有则表示整个参数对象\r\n     */\r\n    getParam(key) {\r\n        if (!this.params) {\r\n            return;\r\n        }\r\n        if (key) {\r\n            return this.params[key];\r\n        }\r\n        return this.params;\r\n    }\r\n    /**\r\n     * 保存参数\r\n     * @param key       key\r\n     * @param value     值\r\n     */\r\n    saveParam(key, value) {\r\n        if (key) {\r\n            this.params[key] = value;\r\n        }\r\n        else {\r\n            this.params = value;\r\n        }\r\n    }\r\n    /**\r\n     * 开始流传\r\n     */\r\n    start() {\r\n        const node = this.nodes.find(item => item instanceof NStartNode);\r\n        if (!node) {\r\n            throw \"流程无开始节点\";\r\n        }\r\n        node.run();\r\n    }\r\n    /**\r\n     * 结束\r\n     */\r\n    end() {\r\n        delete this.currentNode;\r\n        this.finished = true;\r\n    }\r\n    /**\r\n     * 获取节点\r\n     * @param name  节点名称\r\n     * @returns     节点\r\n     */\r\n    getNode(name) {\r\n        return this.nodes.find(item => item.name === name);\r\n    }\r\n    /**\r\n     * 设置当前节点\r\n     * @param node\r\n     */\r\n    setCurrentNode(node) {\r\n        this.currentNode = node;\r\n    }\r\n    /**\r\n     * 执行下一个节点\r\n     * @returns\r\n     */\r\n    next() {\r\n        if (!this.currentNode) {\r\n            return;\r\n        }\r\n        //执行下个流程节点\r\n        let seq = this.getSequenceNode(this.currentNode.name);\r\n        if (seq) {\r\n            seq.run();\r\n        }\r\n    }\r\n    /**\r\n     * 获取顺序流节点\r\n     * @param name      src 或 dst节点名\r\n     * @param isDst     如果name为dst，则该项为true\r\n     */\r\n    getSequenceNode(name, isDst) {\r\n        if (isDst) {\r\n            return this.nodes.find(item => item['dst'] === name);\r\n        }\r\n        return this.nodes.find(item => item['src'] === name);\r\n    }\r\n    /**\r\n     * 获取顺序流节点集合，主要用于网关\r\n     * @param name      src 或 dst节点名\r\n     * @param isDst     如果name为dst，则该项为true\r\n     */\r\n    getSequenceNodes(name, isDst) {\r\n        if (isDst) {\r\n            return this.nodes.filter(item => item['dst'] === name);\r\n        }\r\n        return this.nodes.filter(item => item['src'] === name);\r\n    }\r\n}\r\n//# sourceMappingURL=npageprocess.js.map","references":["/Users/leiyang/develop/codework/jswork/npageflow/core/node/nnode.ts","/Users/leiyang/develop/codework/jswork/npageflow/core/node/nsequencenode.ts","/Users/leiyang/develop/codework/jswork/npageflow/core/node/nstartnode.ts","/Users/leiyang/develop/codework/jswork/npageflow/core/types.ts"],"map":"{\"version\":3,\"file\":\"npageprocess.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../core/npageprocess.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/leiyang/develop/codework/jswork/npageflow/node_modules/.cache/rollup-plugin-typescript2/placeholder/core/npageprocess.d.ts","writeByteOrderMark":false,"text":"import { NNode } from \"./node/nnode\";\r\nimport { NSecquenceNode } from \"./node/nsequencenode\";\r\nexport declare class NPageProcess {\r\n    /**\r\n     * 流程id\r\n     */\r\n    private id;\r\n    /**\r\n     * 流程名\r\n     */\r\n    private name;\r\n    /**\r\n     * 流程标题\r\n     */\r\n    private title;\r\n    /**\r\n     * 流程节点集合\r\n     */\r\n    private nodes;\r\n    /**\r\n     * 当前节点\r\n     */\r\n    private currentNode;\r\n    /**\r\n     * 流程参数\r\n     */\r\n    private params;\r\n    /**\r\n     * 结束标志\r\n     */\r\n    private finished;\r\n    /**\r\n     * 容器\r\n     */\r\n    container: HTMLElement;\r\n    constructor(id: any, cfg: any, container: any);\r\n    /**\r\n     * 获取参数\r\n     * @param key   参数名，如果没有则表示整个参数对象\r\n     */\r\n    getParam(key?: string): any;\r\n    /**\r\n     * 保存参数\r\n     * @param key       key\r\n     * @param value     值\r\n     */\r\n    saveParam(key: string, value: any): void;\r\n    /**\r\n     * 开始流传\r\n     */\r\n    start(): void;\r\n    /**\r\n     * 结束\r\n     */\r\n    end(): void;\r\n    /**\r\n     * 获取节点\r\n     * @param name  节点名称\r\n     * @returns     节点\r\n     */\r\n    getNode(name: string): NNode;\r\n    /**\r\n     * 设置当前节点\r\n     * @param node\r\n     */\r\n    setCurrentNode(node: NNode): void;\r\n    /**\r\n     * 执行下一个节点\r\n     * @returns\r\n     */\r\n    next(): void;\r\n    /**\r\n     * 获取顺序流节点\r\n     * @param name      src 或 dst节点名\r\n     * @param isDst     如果name为dst，则该项为true\r\n     */\r\n    getSequenceNode(name: string, isDst?: boolean): NSecquenceNode;\r\n    /**\r\n     * 获取顺序流节点集合，主要用于网关\r\n     * @param name      src 或 dst节点名\r\n     * @param isDst     如果name为dst，则该项为true\r\n     */\r\n    getSequenceNodes(name: string, isDst?: boolean): NSecquenceNode[];\r\n}\r\n"}}
